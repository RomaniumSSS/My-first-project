# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –†–µ–∂–∏–º –ö—Ä–∏–∑–∏—Å–∞

**–¶–µ–ª—å:** –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∂–∏–º –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥–ª—è –º–æ–º–µ–Ω—Ç–æ–≤, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ç—è–∂—ë–ª–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏. –§–æ–∫—É—Å –Ω–∞ —ç–º–ø–∞—Ç–∏–∏, –¥—ã—Ö–∞–Ω–∏–∏ –∏ –º–∏–∫—Ä–æ-–¥–µ–π—Å—Ç–≤–∏—è—Ö –±–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (MVP)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π (–∫–ª—é—á–µ–≤–∞—è –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞)

---

## –§–∏–ª–æ—Å–æ—Ñ–∏—è —Ä–µ–∂–∏–º–∞

> "–í –º–æ–º–µ–Ω—Ç –∫—Ä–∏–∑–∏—Å–∞ –≤–∞–∂–Ω–æ –Ω–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è, –∞ –¥–µ–ª–∞—Ç—å –º–∞–ª–æ."

- **–ë–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è** ‚Äî –Ω–∏–∫–∞–∫–∏—Ö "—Ç—ã –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª –ø–ª–∞–Ω"
- **–î—ã—Ö–∞–Ω–∏–µ –ø–µ—Ä–≤–∏—á–Ω–æ** ‚Äî —Å–Ω–∞—á–∞–ª–∞ –≤—ã–¥–æ—Ö–Ω—É—Ç—å, –ø–æ—Ç–æ–º –¥—É–º–∞—Ç—å
- **–ú–∏–∫—Ä–æ-–¥–µ–π—Å—Ç–≤–∏–µ** ‚Äî –æ–¥–Ω–æ –¥–µ–ª–æ –Ω–∞ 5-15 –º–∏–Ω—É—Ç
- **–ü—Ä–∏–∑–Ω–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è** ‚Äî "—Ç–µ–±–µ —Ç—è–∂–µ–ª–æ, –∏ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ"

---

## –≠—Ç–∞–ø 0: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –ú–æ–¥–µ–ª–∏

1. **–ú–æ–¥–µ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
   - [x] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `current_mode` –≤ –º–æ–¥–µ–ª—å `User` (enum: `normal`, `crisis`, `burnout`, `uncertainty`)
   - [x] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `mode_updated_at` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤ —Ä–µ–∂–∏–º–µ

2. **FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è:**
   - [x] –°–æ–∑–¥–∞—Ç—å `CrisisStates` –≤ `src/bot/states.py`:
     - `waiting_for_feeling` ‚Äî –æ–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ "–∫–∞–∫ —Ç—ã?"
     - `breathing` ‚Äî —Ä–µ–∂–∏–º –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–π –ø–∞—É–∑—ã
     - `micro_action` ‚Äî –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –º–∏–∫—Ä–æ-–¥–µ–π—Å—Ç–≤–∏—è
     - `just_being` ‚Äî –ø—Ä–æ—Å—Ç–æ —Ä—è–¥–æ–º, –±–µ–∑ –¥–µ–π—Å—Ç–≤–∏–π

3. **–ú–∏–≥—Ä–∞—Ü–∏—è –ë–î:**
   - [x] –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—è –≤ User

---

## –≠—Ç–∞–ø 1: –ö–æ–º–∞–Ω–¥–∞ /crisis –∏ –í—Ö–æ–¥ –≤ —Ä–µ–∂–∏–º

1. **Handler `/crisis`** (`src/bot/handlers/crisis.py`):
   - [x] –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥—ã
   - [x] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ `user.current_mode = 'crisis'`
   - [x] –≠–º–ø–∞—Ç–∏—á–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ:
     ```
     –Ø —Ä—è–¥–æ–º. –ù–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å.
     
     –ö–∞–∫ —Ç—ã —Ö–æ—á–µ—à—å?
     [ üå¨ –ü–æ–¥—ã—à–∞—Ç—å ] [ üí¨ –ù–∞–ø–∏—Å–∞—Ç—å ] [ ü§´ –ü—Ä–æ—Å—Ç–æ –ø–æ–±—ã—Ç—å ]
     ```

2. **Inline-–∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞:**
   - [x] `breathe` ‚Äî –ø–µ—Ä–µ—Ö–æ–¥ –∫ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–µ
   - [x] `talk` ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞–ø–∏—Å–∞—Ç—å —á—Ç–æ —á—É–≤—Å—Ç–≤—É–µ—à—å (–±–µ–∑ –∞–Ω–∞–ª–∏–∑–∞, –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–Ω—è—Ç—å)
   - [x] `just_be` ‚Äî –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç "–Ø —Ç—É—Ç. –ù–∞–ø–∏—à–∏, –∫–æ–≥–¥–∞ –±—É–¥–µ—à—å –≥–æ—Ç–æ–≤." –∏ –∂–¥—ë—Ç

---

## –≠—Ç–∞–ø 2: –î—ã—Ö–∞—Ç–µ–ª—å–Ω–∞—è –ø–∞—É–∑–∞

1. **–¢–µ—Ö–Ω–∏–∫–∞ 4-7-8:**
   - [x] –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ—à–∞–≥–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π:
     ```
     üå¨ –î–∞–≤–∞–π –ø–æ–¥—ã—à–∏–º –≤–º–µ—Å—Ç–µ.
     
     –í–¥–æ—Ö... (4 —Å–µ–∫—É–Ω–¥—ã)
     [–ø–∞—É–∑–∞ 4 —Å–µ–∫]
     
     –ó–∞–¥–µ—Ä–∂–∏... (7 —Å–µ–∫—É–Ω–¥)
     [–ø–∞—É–∑–∞ 7 —Å–µ–∫]
     
     –í—ã–¥–æ—Ö... (8 —Å–µ–∫—É–Ω–¥)
     [–ø–∞—É–∑–∞ 8 —Å–µ–∫]
     
     –ï—â—ë —Ä–∞–∑?
     [ üîÑ –ü–æ–≤—Ç–æ—Ä–∏—Ç—å ] [ ‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ ]
     ```

2. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: Box Breathing (4-4-4-4):**
   - [x] –ë–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è —Ç–µ—Ö, –∫–æ–º—É 4-7-8 —Å–ª–æ–∂–Ω–æ

3. **–ü–æ—Å–ª–µ –¥—ã—Ö–∞–Ω–∏—è:**
   - [x] –ú—è–≥–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥: "–ö–∞–∫ —Ç–µ–ø–µ—Ä—å? –•–æ—á–µ—à—å —Å–¥–µ–ª–∞—Ç—å –æ–¥–Ω–æ –º–∞–ª–µ–Ω—å–∫–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ–±—ã—Ç—å?"

---

## –≠—Ç–∞–ø 3: –ú–∏–∫—Ä–æ-–¥–µ–π—Å—Ç–≤–∏–µ

1. **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –º–∏–∫—Ä–æ-—à–∞–≥–∞:**
   - [x] –ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ –≤ –µ—ë –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
   - [x] –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –±–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è:
     ```
     –ï—Å–ª–∏ –µ—Å—Ç—å —Å–∏–ª—ã ‚Äî –º–æ–∂–µ—à—å —Å–¥–µ–ª–∞—Ç—å –æ–¥–Ω–æ –º–∞–ª–µ–Ω—å–∫–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ.
     –ë—É–∫–≤–∞–ª—å–Ω–æ 5-15 –º–∏–Ω—É—Ç. –ß—Ç–æ —É–≥–æ–¥–Ω–æ –≤ —Å—Ç–æ—Ä–æ–Ω—É —Ü–µ–ª–∏.
     
     –¢–≤–æ—è —Ü–µ–ª—å: [–Ω–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–∏]
     
     –ü—Ä–∏–º–µ—Ä—ã:
     ‚Ä¢ –ù–∞–ø–∏—Å–∞—Ç—å –æ–¥–Ω—É –∏–¥–µ—é
     ‚Ä¢ –ó–∞–¥–∞—Ç—å –æ–¥–∏–Ω –≤–æ–ø—Ä–æ—Å
     ‚Ä¢ –°–¥–µ–ª–∞—Ç—å –æ–¥–∏–Ω –º–∞–ª–µ–Ω—å–∫–∏–π —à–∞–≥
     
     [ üéØ –•–æ—á—É –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å ] [ üõã –ù–µ —Å–µ–π—á–∞—Å ]
     ```

2. **–§–∏–∫—Å–∞—Ü–∏—è –º–∏–∫—Ä–æ-–¥–µ–π—Å—Ç–≤–∏—è:**
   - [x] –ï—Å–ª–∏ –≤—ã–±—Ä–∞–ª "–•–æ—á—É –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å" ‚Äî —Å–ø—Ä–æ—Å–∏—Ç—å —á—Ç–æ —Å–¥–µ–ª–∞–ª (—É–ø—Ä–æ—â—ë–Ω–Ω—ã–π —á–µ–∫-–∏–Ω)
   - [x] –û—Ç–≤–µ—Ç: —ç–º–ø–∞—Ç–∏—á–Ω–∞—è –ø–æ—Ö–≤–∞–ª–∞ –±–µ–∑ –æ—Ü–µ–Ω–∫–∏ –æ–±—ä—ë–º–∞

3. **–ï—Å–ª–∏ "–ù–µ —Å–µ–π—á–∞—Å":**
   - [x] "–≠—Ç–æ —Ç–æ–∂–µ –æ–∫. –Ø —Ç—É—Ç, –µ—Å–ª–∏ —á—Ç–æ. üíô"
   - [x] –ù–µ –Ω–∞—Å—Ç–∞–∏–≤–∞—Ç—å, –Ω–µ –ø–µ—Ä–µ—Å–ø—Ä–∞—à–∏–≤–∞—Ç—å

---

## –≠—Ç–∞–ø 4: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–ú–∞–Ω—Ç—Ä—ã)

1. **–ë–∞–∑–∞ –º–∞–Ω—Ç—Ä/–∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏–π:**
   - [x] –°–æ–∑–¥–∞—Ç—å `src/data/mantras.py` –∏–ª–∏ JSON-—Ñ–∞–π–ª —Å —Ñ—Ä–∞–∑–∞–º–∏:
     ```python
     CRISIS_MANTRAS = [
         "–¢—ã —Å–ø—Ä–∞–≤–ª—è–µ—à—å—Å—è. –î–∞–∂–µ —Å–µ–π—á–∞—Å.",
         "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ—Å—Ç—å ‚Äî —ç—Ç–æ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è –≤—Å–µ—Ö, –∫—Ç–æ –¥–µ–ª–∞–µ—Ç —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ.",
         "–û–¥–∏–Ω —à–∞–≥. –ë–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ.",
         "–¢—ã —É–∂–µ –¥–µ–ª–∞–ª —Å–ª–æ–∂–Ω—ã–µ –≤–µ—â–∏. –¢—ã —Å–¥–µ–ª–∞–µ—à—å –∏ —ç—Ç–æ.",
         "–ú–æ–∂–Ω–æ –Ω–µ –∑–Ω–∞—Ç—å –æ—Ç–≤–µ—Ç. –ú–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –∏–¥—Ç–∏.",
     ]
     ```

2. **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–∞–Ω—Ç—Ä—ã:**
   - [x] –ü–æ—Å–ª–µ –¥—ã—Ö–∞–Ω–∏—è
   - [x] –ü–æ—Å–ª–µ –º–∏–∫—Ä–æ-–¥–µ–π—Å—Ç–≤–∏—è
   - [x] –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ —Ä–µ–∂–∏–º–∞ –∫—Ä–∏–∑–∏—Å–∞

---

## –≠—Ç–∞–ø 5: GIF-–ø–æ–¥–¥–µ—Ä–∂–∫–∞ (–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —è–∫–æ—Ä—å)

GIF –¥–æ–±–∞–≤–ª—è—é—Ç —Ç–µ–ø–ª–æ –∏ —á–µ–ª–æ–≤–µ—á–Ω–æ—Å—Ç—å. –¢–µ–∫—Å—Ç ‚Äî —Ö–æ–ª–æ–¥–Ω—ã–π, GIF ‚Äî —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç.

### 1. –ë–∞–∑–∞ GIF –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

**–§–∞–π–ª:** `src/data/gifs.json`

```json
{
  "support": {
    "description": "–ü–æ–¥–¥–µ—Ä–∂–∫–∞, –æ–±–Ω–∏–º–∞—à–∫–∏, '—è —Ä—è–¥–æ–º'",
    "gifs": [
      {"file_id": "...", "description": "cat hug"},
      {"file_id": "...", "description": "you are not alone"}
    ]
  },
  "breathe": {
    "description": "–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ, –ø—Ä–∏—Ä–æ–¥–∞, –º–µ–¥–∏—Ç–∞—Ü–∏—è",
    "gifs": [
      {"file_id": "...", "description": "ocean waves"},
      {"file_id": "...", "description": "breathing animation"}
    ]
  },
  "celebration_small": {
    "description": "–ú–∞–ª–µ–Ω—å–∫–∏–µ –ø–æ–±–µ–¥—ã, –º—è–≥–∫–æ–µ –ø—Ä–∞–∑–¥–Ω–æ–≤–∞–Ω–∏–µ",
    "gifs": [
      {"file_id": "...", "description": "gentle clap"},
      {"file_id": "...", "description": "small win"}
    ]
  },
  "you_got_this": {
    "description": "–ú–æ—Ç–∏–≤–∞—Ü–∏—è, '—Ç—ã —Å–ø—Ä–∞–≤–∏—à—å—Å—è'",
    "gifs": [
      {"file_id": "...", "description": "you can do it"},
      {"file_id": "...", "description": "believe in yourself"}
    ]
  },
  "rest": {
    "description": "–û—Ç–¥—ã—Ö, '–º–æ–∂–Ω–æ –Ω–µ –¥–µ–ª–∞—Ç—å –Ω–∏—á–µ–≥–æ'",
    "gifs": [
      {"file_id": "...", "description": "cozy blanket"},
      {"file_id": "...", "description": "relax"}
    ]
  }
}
```

### 2. –ü—Ä–æ—Ü–µ—Å—Å –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–∑—ã

- [ ] **–®–∞–≥ 1:** –ù–∞–π—Ç–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ GIF (Giphy, Tenor, –∏–ª–∏ —Å–≤–æ–∏)
- [ ] **–®–∞–≥ 2:** –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É `scripts/upload_gifs.py`:
  ```python
  # –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GIF –±–æ—Ç—É –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç file_id
  # file_id —É–Ω–∏–∫–∞–ª–µ–Ω –¥–ª—è –±–æ—Ç–∞ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å GIF –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
  ```
- [ ] **–®–∞–≥ 3:** –û—Ç–ø—Ä–∞–≤–∏—Ç—å GIF —á–µ—Ä–µ–∑ –±–æ—Ç–∞, –ø–æ–ª—É—á–∏—Ç—å `file_id`
- [ ] **–®–∞–≥ 4:** –°–æ—Ö—Ä–∞–Ω–∏—Ç—å `file_id` –≤ `gifs.json`

### 3. –°–µ—Ä–≤–∏—Å –≤—ã–±–æ—Ä–∞ GIF

**–§–∞–π–ª:** `src/services/gif_service.py`

```python
import random
import json
from pathlib import Path

class GifService:
    def __init__(self):
        self.gifs = self._load_gifs()
    
    def _load_gifs(self) -> dict:
        path = Path(__file__).parent.parent / "data" / "gifs.json"
        with open(path) as f:
            return json.load(f)
    
    def get_random(self, category: str) -> str | None:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π file_id –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
        if category not in self.gifs:
            return None
        gifs = self.gifs[category]["gifs"]
        if not gifs:
            return None
        return random.choice(gifs)["file_id"]
    
    def get_for_context(self, context: str) -> tuple[str, str]:
        """
        LLM –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É.
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç (category, file_id).
        """
        # –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è MVP, –ø–æ—Ç–æ–º –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ LLM
        if "–¥—ã—Ö–∞–Ω" in context.lower() or "–≤—ã–¥–æ—Ö" in context.lower():
            category = "breathe"
        elif "—Å–¥–µ–ª–∞–ª" in context.lower() or "–ø–æ–ª—É—á–∏–ª–æ—Å—å" in context.lower():
            category = "celebration_small"
        elif "—Ç—è–∂–µ–ª–æ" in context.lower() or "–ø–ª–æ—Ö–æ" in context.lower():
            category = "support"
        elif "–æ—Ç–¥—ã—Ö" in context.lower() or "–Ω–µ —Å–µ–π—á–∞—Å" in context.lower():
            category = "rest"
        else:
            category = "you_got_this"
        
        return category, self.get_random(category)

gif_service = GifService()
```

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ handlers

- [x] –ü–æ—Å–ª–µ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–π –ø–∞—É–∑—ã ‚Üí GIF –∏–∑ `breathe`
- [x] –ü–æ—Å–ª–µ –º–∏–∫—Ä–æ-–¥–µ–π—Å—Ç–≤–∏—è ‚Üí GIF –∏–∑ `celebration_small`
- [x] –ü—Ä–∏ –≤—Ö–æ–¥–µ –≤ –∫—Ä–∏–∑–∏—Å ‚Üí GIF –∏–∑ `support`
- [x] –ü—Ä–∏ "–ù–µ —Å–µ–π—á–∞—Å" ‚Üí GIF –∏–∑ `rest`

### 5. –û—Ç–ø—Ä–∞–≤–∫–∞ GIF –≤ Telegram

```python
from aiogram.types import FSInputFile

# –ï—Å–ª–∏ –µ—Å—Ç—å file_id (—É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ Telegram):
await message.answer_animation(animation=file_id)

# –ò–ª–∏ —Å –ø–æ–¥–ø–∏—Å—å—é:
await message.answer_animation(
    animation=file_id,
    caption="–¢—ã —Å–ø—Ä–∞–≤–ª—è–µ—à—å—Å—è. üíô"
)
```

### 6. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –°—Ç–∏–∫–µ—Ä—ã

–ï—Å–ª–∏ GIF —Å–ª–æ–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å ‚Äî –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Telegram —Å—Ç–∏–∫–µ—Ä—ã:
- [ ] –ù–∞–π—Ç–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Å—Ç–∏–∫–µ—Ä–ø–∞–∫
- [ ] –°–æ—Ö—Ä–∞–Ω–∏—Ç—å `file_id` —Å—Ç–∏–∫–µ—Ä–æ–≤
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `message.answer_sticker(sticker=file_id)`

---

## –≠—Ç–∞–ø 6: –í—ã—Ö–æ–¥ –∏–∑ —Ä–µ–∂–∏–º–∞

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã—Ö–æ–¥:**
   - [ ] –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∞–µ—Ç –æ–±—ã—á–Ω—ã–π —á–µ–∫-–∏–Ω –∏–ª–∏ `/new_goal` ‚Äî —Å–ø—Ä–æ—Å–∏—Ç—å:
     ```
     –ü–æ—Ö–æ–∂–µ, —Ç–µ–±–µ –ª—É—á—à–µ. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ –æ–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º?
     [ ‚úÖ –î–∞ ] [ üî¥ –ù–µ—Ç, –ø–æ–∫–∞ –≤ –∫—Ä–∏–∑–∏—Å–µ ]
     ```
   - AICODE-TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞ –≤ checkin.py –∏ goal_setting.py

2. **–†—É—á–Ω–æ–π –≤—ã—Ö–æ–¥:**
   - [x] –ö–æ–º–∞–Ω–¥–∞ `/normal` –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ –≤ –º–µ–Ω—é

3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - [x] –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≤—Ä–µ–º—è –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞ –∏–∑ –∫—Ä–∏–∑–∏—Å–∞ (–¥–ª—è –±—É–¥—É—â–µ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏)

---

## –≠—Ç–∞–ø 7: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º –±–æ—Ç–æ–º

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞ –≤ –¥—Ä—É–≥–∏—Ö handlers:**
   - [ ] –ï—Å–ª–∏ `user.current_mode == 'crisis'` ‚Äî —Å–º—è–≥—á–∞—Ç—å —Ç–æ–Ω –≤–æ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
   - [ ] –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É "–Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö" –∑–∞–¥–∞—á

2. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∫—Ä–∏–∑–∏—Å–∞:**
   - [ ] –õ—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ä–µ–∂–∏–º–µ –∫—Ä–∏–∑–∏—Å–∞ —Å–Ω–∞—á–∞–ª–∞ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç "–∫–∞–∫ —Ç—ã?"

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ crisis.py          # üÜï –û—Å–Ω–æ–≤–Ω–æ–π handler —Ä–µ–∂–∏–º–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ states.py              # + CrisisStates
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ mantras.py             # üÜï –ë–∞–∑–∞ –º–∞–Ω—Ç—Ä
‚îÇ   ‚îî‚îÄ‚îÄ gifs.json              # üÜï –ë–∞–∑–∞ GIF (file_id –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º)
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ gif_service.py         # üÜï –°–µ—Ä–≤–∏—Å –≤—ã–±–æ—Ä–∞ GIF
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ database/
    ‚îî‚îÄ‚îÄ models.py              # + current_mode –≤ User

scripts/
‚îî‚îÄ‚îÄ upload_gifs.py             # üÜï –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ GIF –∏ –ø–æ–ª—É—á–µ–Ω–∏—è file_id
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–°—Ü–µ–Ω–∞—Ä–∏–π A: –ü–æ–ª–Ω—ã–π —Ñ–ª–æ—É**
   - [ ] `/crisis` ‚Üí –ü–æ–¥—ã—à–∞—Ç—å ‚Üí –ü–æ–≤—Ç–æ—Ä–∏—Ç—å 2 —Ä–∞–∑–∞ ‚Üí –ú–∏–∫—Ä–æ-–¥–µ–π—Å—Ç–≤–∏–µ ‚Üí –ó–∞–ø–∏—Å–∞—Ç—å ‚Üí –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É
   - [ ] GIF –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –¥—ã—Ö–∞–Ω–∏—è –∏ –ø–æ—Å–ª–µ –¥–µ–π—Å—Ç–≤–∏—è

2. **–°—Ü–µ–Ω–∞—Ä–∏–π B: –ü—Ä–æ—Å—Ç–æ –ø–æ–±—ã—Ç—å**
   - [ ] `/crisis` ‚Üí –ü—Ä–æ—Å—Ç–æ –ø–æ–±—ã—Ç—å ‚Üí –ë–æ—Ç –∂–¥—ë—Ç ‚Üí –ß–µ—Ä–µ–∑ –≤—Ä–µ–º—è –Ω–∞–ø–∏—Å–∞—Ç—å ‚Üí –ü–æ–ª—É—á–∏—Ç—å –º—è–≥–∫–∏–π –æ—Ç–≤–µ—Ç
   - [ ] GIF –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `support` –ø—Ä–∏ –≤—Ö–æ–¥–µ

3. **–°—Ü–µ–Ω–∞—Ä–∏–π C: –í—ã—Ö–æ–¥**
   - [ ] `/crisis` ‚Üí ... ‚Üí `/checkin` ‚Üí –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≤—ã–π—Ç–∏ –∏–∑ —Ä–µ–∂–∏–º–∞ ‚Üí –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

4. **–°—Ü–µ–Ω–∞—Ä–∏–π D: GIF**
   - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ GIF –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
   - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ GIF –±–æ—Ç –Ω–µ –ø–∞–¥–∞–µ—Ç (graceful fallback)

---

## –†–∏—Å–∫–∏ –∏ AICODE-–∑–∞–º–µ—Ç–∫–∏

- **AICODE-NOTE:** –†–µ–∂–∏–º –∫—Ä–∏–∑–∏—Å–∞ ‚Äî –Ω–µ –∑–∞–º–µ–Ω–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –ø–æ–º–æ—â–∏. –í –±—É–¥—É—â–µ–º –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã (–≥–æ—Ä—è—á–∏–µ –ª–∏–Ω–∏–∏) –¥–ª—è —Ç—è–∂—ë–ª—ã—Ö —Å–ª—É—á–∞–µ–≤.
- **AICODE-NOTE:** GIF —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫ `file_id` Telegram ‚Äî —ç—Ç–æ –±—ã—Å—Ç—Ä–æ –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö API. –ù–æ `file_id` —É–Ω–∏–∫–∞–ª—å–Ω—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞.
- **–†–∏—Å–∫:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç "–∑–∞—Å—Ç—Ä—è—Ç—å" –≤ —Ä–µ–∂–∏–º–µ –∫—Ä–∏–∑–∏—Å–∞. *–†–µ—à–µ–Ω–∏–µ:* –ú—è–≥–∫–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è —á–µ—Ä–µ–∑ 24-48—á: "–ö–∞–∫ —Ç—ã —Å–µ–≥–æ–¥–Ω—è? –í—Å—ë –µ—â—ë –Ω—É–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞?"
- **–†–∏—Å–∫:** GIF –º–æ–≥—É—Ç —É—Å—Ç–∞—Ä–µ—Ç—å –∏–ª–∏ –±—ã—Ç—å –Ω–µ—É–º–µ—Å—Ç–Ω—ã–º–∏. *–†–µ—à–µ–Ω–∏–µ:* –¢—â–∞—Ç–µ–ª—å–Ω—ã–π –æ—Ç–±–æ—Ä, –∏–∑–±–µ–≥–∞—Ç—å –º–µ–º–æ–≤, —Ñ–æ–∫—É—Å –Ω–∞ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã—Ö —ç–º–æ—Ü–∏—è—Ö.

---

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (Definition of Done)

- [x] –ö–æ–º–∞–Ω–¥–∞ `/crisis` —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –î—ã—Ö–∞—Ç–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø–∞—É–∑–∞–º–∏
- [x] –ú–∏–∫—Ä–æ-–¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —Ü–µ–ª–∏
- [x] –ú–∞–Ω—Ç—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –∫–ª—é—á–µ–≤—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤
- [x] GIF –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–∫–∞—Ö (–¥—ã—Ö–∞–Ω–∏–µ, –¥–µ–π—Å—Ç–≤–∏–µ, –ø–æ–¥–¥–µ—Ä–∂–∫–∞)
- [ ] –ë–∞–∑–∞ GIF –Ω–∞–ø–æ–ª–Ω–µ–Ω–∞ –º–∏–Ω–∏–º—É–º 2-3 GIF –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—é (AICODE-TODO: —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–≥–æ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è)
- [x] –†–µ–∂–∏–º —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î –∏ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ç–æ–Ω –±–æ—Ç–∞
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (`docs/architecture.md`)

